This code is inspired from and adapts parts of UEFI-TCP https://github.com/rust-osdev/uefi-rs/pull/1130/files
