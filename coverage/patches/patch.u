.org 0x7c00

<fake_rnd>
rax := ZEROEXT_DSZ32(0x000000aa) SEQW LFNCEWAIT, UEND0

<func_hook>
include <sys/func_hook.up>

<func_ldat_read>
# IN : tmp0 = PDAT_BASE
# IN : tmp1 = SELECTOR
# IN : tmp2 = ADDR
# OUT: rax <- VAL

tmp1 := SHR_DSZ32(tmp1, 0x00000008)
tmp1 := AND_DSZ32(0x0000000f, tmp1)

rbx := OR_DSZ32(0x00000000, tmp1)

rbx := ZEROEXT_DSZ32(0x000)

func lib/pause_frontend(tmp4, rbx)

func lib/ldat_read(tmp2, rax, tmp3, 4)

func lib/resume_frontend(tmp4)

NOP SEQW LFNCEWAIT, UEND0